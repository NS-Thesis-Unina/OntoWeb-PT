---
config:
  theme: mc
  layout: dagre
---
flowchart LR
  ClientEnv["Ambiente client"]

  subgraph Engine["Engine / Tool"]
    Nginx["Nginx reverse proxy"]

    subgraph NodeLayer["Ambiente Node.js"]
      NodeAPI["node-api"]
      NodeWorker["node-worker"]
    end

    Redis["Redis"]
    GraphDB["GraphDB"]
    GraphDBInit["graphdb-init"]
  end

  ClientEnv -- HTTP e WebSocket --> Nginx
  Nginx -- Proxy verso node-api --> NodeAPI

  NodeAPI -- Enqueue job asincroni --> Redis
  NodeWorker -- Consume job --> Redis

  NodeAPI -- SPARQL read/write --> GraphDB
  NodeWorker -- SPARQL write findings --> GraphDB

  GraphDBInit -- Crea repo e importa ontologia --> GraphDB
